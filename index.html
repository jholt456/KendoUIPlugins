<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>KendoUI Plugins by jholt456</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/kendo.ext.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
     <link rel="stylesheet" type="text/css" href="http://cdn.kendostatic.com/2013.2.918/styles/kendo.common.min.css">
    <link rel="stylesheet" type="text/css" href="http://cdn.kendostatic.com/2013.2.918/styles/kendo.default.min.css">
   
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>KendoUI Plugins</h1>
        <p>Misc plugins for Kendo UI</p>

        <p class="view"><a href="https://github.com/jholt456/KendoUIPlugins">View the Project on GitHub <small>jholt456/KendoUIPlugins</small></a></p>


        <ul>
          <li><a href="https://github.com/jholt456/KendoUIPlugins/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/jholt456/KendoUIPlugins/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/jholt456/KendoUIPlugins">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
      <div style="padding-bottom:30px">
		<div id="app"></div>
	   </div>
	
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/jholt456">jholt456</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.js"></script>
     <script type="text/javascript" src="http://cdn.kendostatic.com/2013.2.918/js/kendo.all.min.js"></script>
    <script src="javascripts/scale.fix.js"></script>
    <script src="javascripts/kendo-ext-min.js"></script>
    
    <script>

    
 var views = {};
   

    $(function() {
         
        templateLoader.loadExtTemplate("layout", "layouts/main.html").success(function(result) {
             $("body").append(result);


        var router = new kendo.Router();
        var mainModel = kendo.observable({
                                    isVisible: true,
                                    onSelect: function(e) {
                                        var text = $(e.item).data("route");

                                        if(text) {                                          
                                          router.navigate(text);
                                        } 
                                    } 
                                });

        var layout = new kendo.Layout('#layout', {  model: mainModel, wrap:false });

        layout.render("#app");

       
        var contentArea = $("#body");

       var changePage = function(route, name, path, path, isRemoteLoad) {
            layout.showIn(contentArea, views[name]); // switch view

            $(document).trigger("viewSwtichedEvent", { route: route, name: name, path: path, isRemotelyLoaded: isRemoteLoad }); // publish event view has been loaded (EventAggregator pattern)
            kendo.fx(contentArea).slideInRight().play().then(function() { 
                //fix issue with alignment
                document.getElementById('body').style.WebkitTransform = "none";
            });; // transition, slide view back to the right (center)
       };

         var addRoute = function (route, name, path, forceRemoteLoad, model) {
                    forceRemoteLoad = typeof forceRemoteLoad !== "undefined" ? forceRemoteLoad : false;
                    router.route(route, function () {
                       kendo.fx(contentArea).slideInRight().reverse().then(function () { // transition, slide view left*/
                            
                            ensureView(name, path, model, forceRemoteLoad).then( function(x) {
                                changePage(route, name, path, x); 
                            });
                        });
                    });
                };

 

        addRoute("/", "home", "views/home.html");

        //Basic Range Picker
        addRoute("/ExtRangePicker/Date", "date", "views/extRangePicker/date.html");
        addRoute("/ExtRangePicker/Calendar", "calendar", "views/extRangePicker/calendar.html");
        addRoute("/ExtRangePicker/Numeric", "numeric", "views/extRangePicker/numeric.html");


        //Drop down range picker
        addRoute("/ExtDropDown/Numeric", "ext-dd-custom-numeric", "views/extDropDown/numeric.html");
        addRoute("/ExtDropDown/Date", "ext-dd-custom-date", "views/extDropDown/date.html");
        addRoute("/ExtDropDown/Calendar", "ext-dd-custom-calendar", "views/extDropDown/calendar.html");
        addRoute("/ExtDropDown/Grid", "ext-dd-custom-grid", "views/extDropDown/grid.html");
        addRoute("/ExtDropDown/Widget", "ext-dd-widget", "views/extDropDown/widget.html");

         //Drop down range picker
        addRoute("/ExtDropDownRangePickers/Numeric", "ext-dd-numeric", "views/extDropDownRangePickers/numeric.html");
        addRoute("/ExtDropDownRangePickers/Date", "ext-dd-date", "views/extDropDownRangePickers/date.html");
        addRoute("/ExtDropDownRangePickers/Calendar", "ext-dd-calendar", "views/extDropDownRangePickers/calendar.html");
        addRoute("/ExtDropDownRangePickers/AdvancedDatePicker", "ext-dd-ext-date-picker", "views/extDropDownRangePickers/advancedDatePicker.html");


        addRoute("/ExtDateRangePicker", "full", "views/rangePicker.html");

        

        router.start();
 });
         
    });

    

     var templateLoader = (function ($, host) {
            return {
                loadExtTemplate: function (name, path) {
                    return $.ajax({
                        async: false,
                        url: path,
                        cache: false,
                       
                        error: function (result) {
                            alert("Error Loading View/Template -- TODO: Better Error Handling");
                        }
                    });
                }
            };
        })(jQuery, document);

    var ensureView = function(name, path, model, force) {
        var def = $.Deferred();


         if (views[name] == null || force) {
             templateLoader.loadExtTemplate(name, path)
                         .success(function(result) {
                                     views[name] = new kendo.View($(result), {model:model});

                                     def.resolve(true);
                                 }); 
             
         } else {
             def.resolve(false);
         }

         return def.promise();
    }


    function changed(e) {
        console.log("changed (event binding)");
        console.log(e.sender.value());
    } 

    function changed2(e) {
        console.log("changed (options bound)");
        console.log(e.sender.value());
    } 

    function formatValue(val, format) {
        if(val && (val.from || val.to)) {
            return kendo.format("{0} - {1}", kendo.toString(val.from, format) || "and Before", kendo.toString(val.to, format) || "and After");
        }
        return "";
    }
 
</script>
  </body>
</html>
